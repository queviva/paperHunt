<!doctype html>
<html>

<head>
	<title>pack hunt</title>
	<style>
		#holder {
			position: relative;
			margin: auto;
			width: 700px;
			height: 560px;
			background-color: #eee;
			overflow: hidden;
			/*transform: scale(0.7,0.7);
	transform-origin: 50% 0%;*/
		}

		#notes {
			margin: auto;
			position: relative;
			width: 680px;
			/*height:250px;*/
			background-color: #ea3;
			padding: 10px;
			border: 1px solid #000;
			overflow: hidden;
			/*visibility:hidden;*/
			/*display:none;*/
		}

		#sliderDiv {
			margin: auto;
			position: relative;
			width: 478px;
			height: 150px;
			background-color: #ea3;
			padding: 10px;
			border: 1px solid #000;
			overflow: hidden;
		}

		input {
			margin: auto;
			position: relative;
			top: 0px;
			width: 700px;
			height: 25px;
			background-color: #ea3;
			display: block;
		}

		div {
			position: absolute;
		}

		img {
			position: absolute;
			opacity: .65;
		}

		.burbuja {
			border: 2px solid #fff;
			visibility: hidden;
		}
	</style>
</head>

<body>


	<input id="butt0" type="button" value="XXX" onclick="this.c=(typeof(this.c)==='undefined')?1:this.c+1;stopStart(c%2);" />
	<div id="holder"></div>
	<div id="notes">

	</div>

	<!--script src="peligrUtils.js"></script-->
	<script type="text/javascript">
		//////////////////////////////////////////////////////////////
		// pizzaFace
		//
		// el mundo donde to'la gente siguen a salir zonas de peligras
		//////////////////////////////////////////////////////////////

		// utils


		// corteza para referencia
		function $(id) {
			var D = document.getElementById(id);
			D.s = D.style;
			D.cs = window.getComputedStyle(D, null);
			return D;
		}

		// corteza para numeros azar
		var azar = function(x) { return Math.random() * x; }

		// apodo
		var rand = azar;

		var shuffle = function(x) {
			return x.sort(function() { return 0.5 - Math.random() });
		};

		var fadeVal = function(per, A, B) {
			return (A - ((A - B) * per));
		};

		var fadeArray = function(per, A, B) {
			var tmp = [];
			for (var i in A) {
				//tmp[i] = ~~(A[i]-((A[i]-B[i])*per));
				tmp[i] = (A[i] - ((A[i] - B[i]) * per));
			}
			return tmp;
		};

		var fadeArrayINT = function(per, A, B) {
			var tmp = [];
			for (var i in A) {
				tmp[i] = ~~(A[i] - ((A[i] - B[i]) * per));
			}
			return tmp;
		};

		// alias
		var fadeColor = fadeArrayINT;

		// get some references
		var holder = $('holder');
		//var notes  = $('notes' );
		var butt0 = $('butt0');

		// lista de los values-files
		//var listaVals = ['test00.js','test01.js','test02.js'];

		// values-file llamaran esta funcion on load
		//function setStepsArray(v){
		//...hace alguna cosa
		//}

		// some useful screen variables
		var screenW = holder.offsetWidth;
		var screenH = holder.offsetHeight;
		var screenD = 255;
		var screenW2 = ~~(screenW / 2);
		var screenH2 = ~~(screenH / 2);
		var screenD2 = ~~(screenD / 2);
		var screenWW = screenW2 * screenW2;
		var screenHH = screenH2 * screenH2;

		var Math180pi = 57.28578; // = 180/Math.PI;
		var colorPer = '#fff';
		var colorPeli = '#ea0';
		var colorNeg = '#c30';

		// tipos de peligrObjectos defalatos
		var TPO = [

			// nombre,
			// salud,
			// posicion, velocidad, mobilidad, direccion, colores
			// tamano,   duracion,  quantidad

			// velocidad en pixeles per segundo
			// duracion en millisegundos
			// colores en decimal RGB

			{
				nom: 'terra',
				sal: .5,
				pos: null,
				vmx: 10,
				mob: [0, 0, 0],
				dir: 0,
				col: [
					[138, 92, 46],
					[51, 153, 51]
				],
				tam: [28, 28, 0],
				dur: 1000,
				cnt: 0
			},

			{
				nom: 'manada',
				sal: 1,
				pos: null,
				vmx: 10,
				mob: [1, 1, 0],
				dir: 0,
				col: [
					[0, 0, 0],
					[204, 51, 0]
				],
				tam: [14, 14, 0],
				dur: 230,
				cnt: 0
			},

			{
				nom: 'cazadora',
				sal: 1,
				pos: null,
				vmx: 20,
				mob: [1, 1, 0],
				dir: 0,
				col: [
					[0, 0, 0],
					[153, 102, 102]
				],
				tam: [8, 8, 0],
				dur: 1000,
				cnt: 0
			},

			{
				nom: 'ambiente',
				sal: 1,
				pos: [screenW2, screenH2, 0],
				vmx: 2,
				mob: [0, 0, 0],
				dir: 0,
				col: [
					[0, 0, 0],
					[0, 0, 0]
				],
				tam: [screenW, screenH, 0],
				dur: 3000,
				cnt: 0
			},

		];

		// miedos - fears
		var zonaMesa = [
			[700, 8, 70, 0], //[99,12,100,0],   //terra
			[29, 28, 175, 0], //[42,40,250,0],   //manada
			[35, -14, 281, 0], //[50,-20,405,0],  //cazadora
			[0, 0, 0, 0] //ambiente
		];

		var lista = [

			// ambiente
			//{tip:3},

			// terras imuebles {
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },
			{ tip: 0, vmx: 10, pos: [rand(screenW), rand(screenH), 0] },

			// manada muebles
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, pos: [210 + rand(185), 280 + rand(35), 0], mob: [1, 1, 1] },
			{ tip: 1, dur: 50, vmx: 5, sal: 0.75, pos: [210 + rand(185), 280 + rand(35), 0],
			  mob: [1, 1, 1], col: [ [0, 0, 0], [200, 180, 0] ] },

			// cazadoras
			{ tip: 2, dur: 50 + rand(300), pos: [560 + rand(70), 280 + rand(35), 0],
			  vmx: 1 + rand(2), col: [[0, 0, 0],[0, 200, 20]] },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0],
			  vmx: 3.5, col: [[0, 0, 0],[20, 0, 200]] },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0], vmx: 3.1 },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0], vmx: 3.2 },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0], vmx: 3.3 },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0], vmx: 3.0 },
			{ tip: 2, dur: 50, pos: [560 + rand(70), 280 + rand(35), 0], vmx: 3.0 }

		];


		// para recordar todos los peligrobjectos en el mundo
		var todasObj = [];


		/////////////////////////////////////////////////////////////////////
		// class para miembros del mundo

		function PeligrObj(iDex, vals) {

			var PO = this;
			this.name = TPO[vals.tip].nom + ('00' + TPO[vals.tip].cnt++).slice(-3);
			this.iDex = iDex;
			this.health = vals.sal;
			this.vals = vals;
			this.msg = '';
			this.vecinos = [];
			this.curDIF = 0;
			this.curVEL = 0;
			this.curPOS = vals.pos;
			this.loopTimeOut;
			this.oldVEC = [rand(2) - 1, rand(2) - 1, rand(2) - 1, 0];
			//this.newVEC = this.oldVEC;
			this.newVEC = [rand(2) - 1, rand(2) - 1, rand(2) - 1, 0];
			this.curVEC = this.oldVEC;
			this.oldORI = [
				//~~(90+Math.atan2(this.oldVEC[1],this.oldVEC[0])*Math180pi),0,0
				~~(Math.atan2(this.oldVEC[1], this.oldVEC[0]) * Math180pi), 0, 0
			];
			this.newORI = this.oldORI;
			this.curORI = this.oldORI;
			this.oldTAM = vals.tam;
			this.newTAM = vals.tam;
			this.curTAM = vals.tam;
			this.oldCOL = vals.col[1];
			this.newCOL = vals.col[1];
			this.curCOL = vals.col[1];


			this.div = document.createElement('div');
			this.divS = this.div.style;
			// posicion initial NO es del centro
			this.divS.left = this.curPOS[0] - this.curTAM[0] + 'px';
			this.divS.top = this.curPOS[1] - this.curTAM[1] + 'px';
			this.divS.width = this.curTAM[0] + 'px';
			this.divS.height = this.curTAM[1] + 'px';
			//this.divS.border = '1px solid #fff';
			this.divS.borderRadius = this.curTAM[0] / 2 + 'px';
			//(vals.tip === 0) ? 13 : (vals.tip === 3) ? 0 : ~~((this.curTAM[0]/2));
			this.divS.backgroundColor = 'rgb(' + this.curCOL.toString() + ')';

			/*
			ponerDiv(this.div,
				curPOS[0]-vals.tam[0]/2,curPOS[1]-vals.tam[1]/2,
				vals.tam[0],vals.tam[1],0,null,
			//(vals.tip === 0) ? 13 : (vals.tip === 3) ? 0 : ~~((vals.tam[0]/2)),
			~~((vals.tam[0]/2)),
				vals.col[1]
			);
			*/

			//crea la imagen para girar
			this.mig = document.createElement('img');
			//this.mig.src = 'migs/tank_bad.jpg';
			this.mig.src = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAeAB4AAD/4RDARXhpZgAATU0AKgAAAAgABQESAAMAAAABAAEAAAExAAIAAAAuAAAIVgEyAAIAAAAUAAAIhIdpAAQAAAABAAAImOocAAcAAAgMAAAASgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE1pY3Jvc29mdCBXaW5kb3dzIFBob3RvIFZpZXdlciA2LjEuNzYwMC4xNjM4NQAyMDEzOjA2OjA1IDE0OjU2OjQ1AAAB6hwABwAACAwAAAiqAAAAABzqAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/4TG4aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pg0KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyI+PHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+PHhtcDpDcmVhdG9yVG9vbD5NaWNyb3NvZnQgV2luZG93cyBQaG90byBWaWV3ZXIgNi4xLjc2MDAuMTYzODU8L3htcDpDcmVhdG9yVG9vbD48L3JkZjpEZXNjcmlwdGlvbj48L3JkZjpSREY+PC94OnhtcG1ldGE+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSd3Jz8+/9sAQwACAQEBAQICAgICAwICAgIDAwMDAwUGBwUDBAQGCQgHBwYHBwcHCAoICAkLCwoKDQoHBwwMDAwN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';
			//this.mig.src = 'data:image/svg+xml;utf8,<svg id="f69SVG" height="112px" width="122px" xmlns="http://www.w3.org/2000/svg" transform="scale(1, 1)"> <g transform="translate(1 1)" stroke-width="1.5">  <path fill="#090" stroke="#000" d=" M 0 50 A 60 50 0 0 1 120 50 L 60 110 Z "/>  <path fill="#c70" stroke="#000" d=" M 30 80 A 14.14 14.14 0 0 1 60 50 A 14.14 14.14 0 0 1 90 80 L 60 110 Z  M 45 85 A 10 10 0 0 0 45 75 L 55 65 A 10 10 0 0 0 65 65 L 75 75 A 10 10 0 0 0 75 85 L 65 95 A 10 10 0 0 0 55 95 Z  M 55 80 A 5 5 0 0 1 65 80 A 5 5 0 0 1 55 80 Z " fill-rule="evenodd"/>  <path fill="#fff" stroke="#000" d=" M 60 50 L 65 55 L 60 60 L 55 55 Z M 30 80 L 35 75 L 40 80 L 35 85 Z M 80 80 L 85 75 L 90 80 L 85 85 Z M 56 106 V 101 H 64 V 106 L 60 110 Z "/> <path fill="#090" stroke="#000" d="  " fill-rule="evenodd"/> </g>  </svg> ';
			this.mig.style.position = 'absolute';
			this.mig.style.height = this.vals.tam[0] + 'px';
			this.mig.style.width = this.vals.tam[1] + 'px';
			this.mig.style.MozTransform = 'rotate(' + this.curORI[0] + 'deg)';
			this.mig.style.webkitTransform = 'rotate(' + this.curORI[0] + 'deg)';
			this.div.appendChild(this.mig);

			this.bur = document.createElement('div');
			this.burS = this.bur.style;
			// (obj,L,T,W,H,B,BC,R,C,Z)
			/*
			ponerDiv(this.bur,
				vals.pos[0]-vals.tam[0]/2,vals.pos[1]-vals.tam[1]/2,
				vals.tam[0],vals.tam[1],0,null,
			//vals.tam[0]/2,
				(vals.tip === 0) ? 0 : (vals.tip === 3) ? 0 : ~~((vals.tam[0]/2))
			);
			*/
		}

		PeligrObj.prototype.moveLoop = function(start) {

			this.curDIF = (+new Date - start);
			var PO = this;
			var per = this.curDIF / (this.vals.dur / this.vals.sal);

			if (per < 1) {

				this.curVEC = fadeArray(per, this.oldVEC, this.newVEC);
				this.curTAM = fadeArray(per, this.oldTAM, this.newTAM);
				this.curCOL = fadeArray(per, this.oldCOL, this.newCOL);

				this.curPOS[0] = this.curPOS[0] + this.curVEC[0] * this.curVEC[3] * per * this.vals.mob[0];
				this.curPOS[1] = this.curPOS[1] + this.curVEC[1] * this.curVEC[3] * per * this.vals.mob[1];
				this.curPOS[2] = this.curPOS[2] + this.curVEC[2] * this.curVEC[3] * per * this.vals.mob[2];

				//this.curORI[0] = ~~(90 + Math.atan2(
				this.curORI[0] = ~~(Math.atan2(
					this.curVEC[1],
					this.curVEC[0]
				) * Math180pi);

				//this.divS.left   = (this.curPOS[0]-this.curTAM[0]/2) +'px';
				//this.divS.top    = (this.curPOS[1]-this.curTAM[1]/2) +'px';
				//this.divS.front  = (this.curPOS[2]-this.curTAM[2]/2) +'px';
				this.divS.left = ((((this.curPOS[0] - this.curTAM[0] / 2) % screenW) + screenW) % screenW) - this.curTAM[0] / 2 + 'px';
				this.divS.top = ((((this.curPOS[1] - this.curTAM[1] / 2) % screenH) + screenH) % screenH) - this.curTAM[1] / 2 + 'px';
				//this.divS.front  = ((((this.curPOS[2]-this.curTAM[2]/2)%screenD)+screenD)%screenD)-this.curTAM[2]/2 +'px';

				this.divS.width = this.curTAM[0] + 'px';
				this.divS.height = this.curTAM[1] + 'px';
				//this.divS.depth  = this.curTAM[2] +'px';

				if (this.vals.tip === 1) {
					this.divS.borderRadius = this.curTAM[0] / 2 + 'px';
				}

				this.divS.backgroundColor = 'rgb(' + this.curCOL.toString() + ')';
				this.mig.style.MozTransform = 'rotate(' + this.curORI[0] + 'deg)';
				this.mig.style.webkitTransform = 'rotate(' + this.curORI[0] + 'deg)';

				this.loopTimeOut = setTimeout(function() { PO.moveLoop(start); }, 0);

			}
			else {

				recalc(this);
				this.moveLoop(+new Date);

			}
		};

		PeligrObj.prototype.getBoRad = function() {
			return this.div.style.borderRadius;
		};

		PeligrObj.prototype.setPeliBur = function(size, Z, BC) {

			// burbujitas penquenas demasidas nechitan a menos cinco
			// para tener una frontera de css

			if (size[0] < 0 || size[1] < 0) { BC = colorNeg; }
			for (var i in size) {
				size[i] = Math.abs(size[i]);
				size[i] = size[i] <= 5 ? 5 : size[i];
			}
			var tmpCenter = this.getCenter();
			this.burS.position = 'absolute';
			this.burS.left = tmpCenter[0] - size[0] / 2 + 'px';
			this.burS.top = tmpCenter[1] - size[1] / 2 + 'px';
			//this.burS.front  = tmpCenter[2] - size[2]/2 +'px';
			this.burS.width = size[0] - 4 + 'px';
			this.burS.height = size[1] - 4 + 'px';
			//this.burS.depth  = size[2]-4 +'px';
			this.burS.zIndex = 100 * lista.length; //Z;
			this.burS.border = '2px solid ' + (BC || colorPeli);
			this.burS.borderRadius = ((size[0] + 2) / 2) + 'px';
			this.burS.visibility = 'visible';

		};

		PeligrObj.prototype.getCenter = function() {
			return [
				(parseInt(this.divS.left) + ~~(this.curTAM[0] / 2)),
				(parseInt(this.divS.top) + ~~(this.curTAM[1] / 2)),
				//(parseInt(this.divS.front) + ~~(this.curTAM[1]/2))
				this.curPOS[2] // en luga de style.front
			];
		};


		/////////////////////////////////////////////////////////////
		// metodos de la escena
		/////////////////////////////////////////////////////////////

		var recalc = function(obj) {

			obj.msg = ''; // blanca mensaje
			obj.oldCOL = obj.newCOL;
			obj.oldTAM = obj.newTAM;
			obj.oldVEC = obj.newVEC;
			obj.newVEC = [0, 0, 0, 0];

			var tmpV = []; // copia de vecinos
			var negV = []; // miedos negativos
			var dxTOT = 0;
			var dyTOT = 0;
			var dzTOT = 0;

			var miPos = obj.getCenter();

			for (var i in todasObj) {

				var TO = todasObj[i];
				var suPos = TO.getCenter();

				var dX = miPos[0] - suPos[0];
				var dY = miPos[1] - suPos[1];
				var dZ = miPos[2] - suPos[2];

				// si quiere, ajusta para mundo ciclico
				//
				if (dX * dX > screenWW) {
					dX = miPos[0] - (suPos[0] + ((dX < 0) ? -screenW : screenW));
				}
				if (dY * dY > screenHH) {
					dY = miPos[1] - (suPos[1] + ((dY < 0) ? -screenH : screenH));
				}
				//

				//var dis = Math.sqrt(dX * dX + dY * dY + dZ * dZ);
				var dis = Math.sqrt(dX * dX + dY * dY);

				var tmpBur = lista[obj.iDex].zonas[TO.iDex];
				var sgn = tmpBur < 0 ? -1 : 1;

				tmpBur += sgn * TO.curVEL;
				//tmpBur += TO.curVEL;

				//var del = dis - obj.curTAM[0]/2 - sgn*tmpBur/2;
				var del = dis - obj.curTAM[0] / 2 - tmpBur / 2;

				if (sgn < 0 && obj.iDex != TO.iDex) { // miedos negativos
					negV[negV.length] = [del, dis, dX, dY, dZ, tmpBur, TO, i];
				}
				else if (del < 0 && obj.iDex != TO.iDex) {
					if (dis == 0) {
						dX = rand(2) - 1;
						dY = rand(2) - 1;
						dZ = rand(screenD);
						dis = Math.sqrt(dX * dX + dY * dY);
					}
					obj.msg += 'VEO ' + TO.name + ' a ' + ~~dis + 'px';
					obj.msg += '<br/>';
					tmpV[tmpV.length] = [i, [tmpBur, tmpBur, 0]];

					dX = (dX / dis) * (TO.vals.vmx);
					dY = (dY / dis) * (TO.vals.vmx);
					dZ = (dZ / dis) * (TO.vals.vmx);
					dxTOT += dX;
					dyTOT += dY;
					dzTOT += dZ;
				}
			}

			if (negV.length !== 0) {

				negV.sort(function(a, b) { return a[1] - b[1]; });

				del = negV[0][0];
				dis = negV[0][1];
				tmpBur = negV[0][5];

				if (dis > -tmpBur / 2) {

					// negV[negV.length] = [del,dis,dX,dY,dZ,tmpBur,TO,i];
					var NegO = negV[0][6];

					dX = negV[0][2];
					dY = negV[0][3];
					dZ = negV[0][4];

					if (dis === 0) {
						dX = rand(2) - 1;
						dY = rand(2) - 1;
						dZ = rand(screenD);
						dis = Math.sqrt(dX * dX + dY * dY);
					}

					obj.msg += 'NEG ' + NegO.name + ' a ' + ~~dis + 'px';
					obj.msg += '<br/>';
					tmpV[tmpV.length] = [negV[0][7],
						[tmpBur, tmpBur, 0]
					];

					dX = -(dX / dis) * (NegO.vals.vmx);
					dY = -(dY / dis) * (NegO.vals.vmx);
					dZ = -(dZ / dis) * (NegO.vals.vmx);

					dxTOT += dX;
					dyTOT += dY;
					dzTOT += dZ;

				}
				else { // devour when eaten

					// reduce health
					makeNote(obj.name +' bit '+negV[0][6].name + '<br>');
					// note if slowest member
					if(obj.name == 'cazadora000'){makeNote('<br>!!! bite by slowest<br>');}
					
					negV[0][6].vals.sal -= .5;
					if (negV[0][6].vals.sal <= 0) { //if negative health ...
					
						// note the destruction
						makeNote('<br> -- kill: '+ obj.name +' devoured '+negV[0][6].name +'<br>');
						
						// debug - note only sick hunters
						//if(obj.name == 'cazadora000'){makeNote(obj.name +' ate '+negV[0][6].name,1);}
						if(obj.name == 'cazadora000'){makeNote('<br>!!! - kill by slowest member - !!!<br>');}
						
						// turn invisible
						negV[0][6].div.style.display = 'none';
						// debug - mark the dead zone
						var tmpD = document.createElement('div');
						tmpD.style.position = 'absolute';
						tmpD.style.border = '1px solid ' + negV[0][6].div.style.backgroundColor;
						tmpD.style.borderRadius = '50%';
						tmpD.style.width = '10px'
						tmpD.style.height = '10px'
						tmpD.style.top = negV[0][6].div.style.top;
						tmpD.style.left = negV[0][6].div.style.left;
						holder.appendChild(tmpD);

						// remove from list of all objects
						delete(todasObj[negV[0][6].iDex]);

					}

				}

			}


			// anada vector de antes
			dxTOT += (tmpV.length == 0) ? 0 : obj.oldVEC[0];
			dyTOT += (tmpV.length == 0) ? 0 : obj.oldVEC[1];
			dzTOT += (tmpV.length == 0) ? 0 : obj.oldVEC[2];
			//dxTOT += obj.oldVEC[0];
			//dyTOT += obj.oldVEC[1];
			//dzTOT += obj.oldVEC[2];


			var mag = Math.sqrt(dxTOT * dxTOT + dyTOT * dyTOT);

			var tmpCurVel = mag * obj.health;

			if (mag == 0) {
				dxTOT = 0;
				dyTOT = 0;
				tmpCurVel = 0;
			}
			else {
				tmpCurVel = (tmpCurVel > obj.vals.vmx) ? obj.vals.vmx : tmpCurVel;
				dxTOT = (dxTOT / mag);
				dyTOT = (dyTOT / mag);
				obj.newVEC = [dxTOT, dyTOT, dzTOT, tmpCurVel];
			}

			/*
			if(obj.name == 'cazadora000'){
				negV.sort(function(a,b){
					return a[1] - b[1];
				});
				var tmpNote = '';
				for(var i=0;i<negV.length;i++){
					tmpNote += 'VEO NEG ::: ' +negV[i][6].name +' '+ negV[i][1] +'<br/>';
				}
				makeNote(tmpNote);
			}
			if(obj.vals.tip == 1){
				//makeNote(obj.name +'<br/>'+ dyTOT +'<br/>'+ tmpCurVel);
				//makeNote(obj.name +'<br/>'+ obj.vals.vmx +'<br/>'+ tmpCurVel);
			}
			*/

			obj.curVEL = tmpCurVel;

			// rescrito los vecinos
			obj.vecinos = tmpV;


		};



		var monstrarBurbujas = function(obj) {
			var tmpVec = obj.vecinos;
			notes.style.display = 'block';
			//makeNote(obj.name +'<br/>'+ obj.msg);
			for (var i in tmpVec) {
				todasObj[tmpVec[i][0]].setPeliBur(tmpVec[i][1], 100 * lista.length);
			}
			obj.setPeliBur(obj.curTAM, 100 * lista.length + tmpVec.length, colorPer);
			obj.burS.borderRadius = obj.getBoRad();
		};

		var oscurBurbujas = function(obj) {
			var tmpVec = obj.vecinos;
			//makeNote('');
			obj.burS.visibility = 'hidden';
			obj.burS.zIndex = 1;
			for (var i in todasObj) {
				todasObj[i].burS.visibility = 'hidden';
			}
			notes.style.display = 'none';
		};

		var addClicks = [
			function(obj) {
				obj.div.onmousedown = function() { monstrarBurbujas(obj); };
				holder.onmouseup = function() { oscurBurbujas(obj); };
				obj.bur.onmouseout = function() { oscurBurbujas(obj); };
			},
			function(obj) {
				obj.div.onmousedown = '';
				holder.onmouseup = '';
				obj.bur.onmouseout = '';
			}
		];

		var pause = [
			function(id) { clearTimeout(id.loopTimeOut); },
			function(id) { id.moveLoop((+new Date) - id.curDIF) }
		];

		function stopStart(v) {
			for (var i in todasObj) {
				pause[v](todasObj[i]);
				//addClicks[v](todasObj[i]);
			}
		}

		////////////////////////////////////////////////////////////////////

		In_Principio_Erat_Verbum = function() {

			for (var i = 0, k = lista.length; i < k; i++) {

				lista[i].zonas = [];

				// crea la mesa de las zonas
				for (var j = 0, jj = lista.length; j < jj; j++) {
					lista[i].zonas[j] = zonaMesa[lista[i].tip][lista[j].tip];
				}

				// cada los objecto deban a tener un tipo
				if (!TPO[lista[i].tip]) { alert('no hay tal tipo') }
				else {
					// mira para vals, o usa defalta
					for (var j in TPO[lista[i].tip]) {
						lista[i][j] = (lista[i][j]) ? lista[i][j] : TPO[lista[i].tip][j];
					}
					// si no hay posicion, pone les azada
					if (lista[i].pos == null) {
						lista[i].pos = [
							rand(screenW),
							rand(screenH),
							rand(screenD)
						]
					}
					todasObj[i] = new PeligrObj(i, lista[i]);
					holder.appendChild(todasObj[i].div);
					holder.appendChild(todasObj[i].bur);
				}

				if (i != lista.length - 1) {
					lista[lista.length - 1].sal += lista[i].sal;
				}
				
				// empieza el mundo con cliques y pauzada
				//addClicks[0](todasObj[i]);
			}

			// pone niveles por mobilidad en direccion XY
			todasObj.sort(function(a, b) {
				return a.vals.mob[0] - b.vals.mob[0];
			});
			for (var i in todasObj) {
				todasObj[i].divS.zIndex = i;
				if (todasObj[i].name === 'ambiente000') {
					// ambiente nechita ser la bajada
					todasObj[i].divS.zIndex = 0;
				}
				recalc(todasObj[i]);
			}
		}();


		/////////////////////////////////////////////////////

		// para hacer notas
		function makeNote(v,overwrite){notes.innerHTML = (overwrite) ? v : notes.innerHTML + v;}

		// para generar hojas de valores
		//exportValuesFile(csvData);

		// para empezar/parar en barre espacio
		/*
		window.addEventListener('keypress',function(e){
			if(e.charCode !== 32){return;}
			this.c=(typeof(this.c)==='undefined')?1:this.c+1;
			stopStart(c%2);
		},false);
		*/
	</script>
</body>

</html>
